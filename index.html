<div include-html="header.html"></div>

<div id="main-wrapper">
  <h1>פתרונות</h1>
  <p>כאן יהיו פתרונות…</p>
</div>

<div include-html="footer.html" id="site-footer"></div>
<script src="include.js"></script>
<!DOCTYPE html>
<html lang="he">
<head>
  <meta charset="UTF-8" />
  <title>Yoav's Physics Notes</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div include-html="header.html"></div>

  <div id="tree-container">
    <div id="content">טוען…</div>
  </div>

  <script>
    async function loadTree() {
      const res = await fetch("https://raw.githubusercontent.com/YoavsPhysicsNotes/yoavsphysicsnotes.github.io/main/tree.json?ts=" + Date.now());
      return await res.json();
    }

    function renderNode(node) {
      if (node.type === "pdf") {
        const div = document.createElement("div");
        div.className = "pdf-item";
        const a = document.createElement("a");
        a.className = "pdf-link";
        a.href = "https://cdn.jsdelivr.net/gh/YoavsPhysicsNotes/yoavsphysicsnotes.github.io/" + node.path;
        a.target = "_blank";
        a.textContent = node.name.replace(/\.pdf$/i, "");

        if (node.last_modified) {
          const dateSpan = document.createElement("span");
          const d = new Date(node.last_modified);
          dateSpan.className = "file-date";
          dateSpan.textContent = "תאריך עדכון: " +
            d.toLocaleDateString("he-IL") + " " +
            d.toLocaleTimeString("he-IL", { hour: "2-digit", minute: "2-digit" });

          const wrapper = document.createElement("div");
          wrapper.className = "pdf-row";
          wrapper.appendChild(a);
          wrapper.appendChild(dateSpan);

          const icon = document.createElement("span");
          icon.className = "icon pdf";
          wrapper.prepend(icon);
          return wrapper;
        }

        const icon = document.createElement("span");
        icon.className = "icon pdf";
        div.appendChild(a);
        div.prepend(icon);
        return div;
      }

      if (node.type === "dir") {
        const det = document.createElement("details");
        const sum = document.createElement("summary");
        sum.textContent = node.name;

        const icon = document.createElement("span");
        icon.className = "icon folder";
        sum.prepend(icon);
        det.appendChild(sum);

        node.children.forEach(child => {
          det.appendChild(renderNode(child));
        });

        return det;
      }
    }

    async function load() {
      const tree = await loadTree();
      const container = document.getElementById("content");
      container.innerHTML = "";

      tree.forEach(node => {
        if (!node.name.startsWith(".")) container.appendChild(renderNode(node));
      });
    }

    load();
  </script>

  <div include-html="footer.html" id="site-footer"></div>
  <script src="include.js"></script>
</body>
</html>